<!DOCTYPE html><html lang="ko"><head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Board Parts ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&amp;display=swap" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://ai-public.creatie.ai/gen_page/tailwind-custom.css" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com/3.4.5?plugins=forms@0.5.7,typography@0.5.13,aspect-ratio@0.4.2,container-queries@0.1.1"></script><script>if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {document.documentElement.classList.add('dark')} else {document.documentElement.classList.remove('dark')}</script>
    <script src="https://ai-public.creatie.ai/gen_page/tailwind-config.min.js" data-color="#FFA500" data-border-radius="small"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.5.0/echarts.min.js"></script>
    <style>
        :root {
            --custom-color: #e65802; /* ë°ì€ ì˜¤ë Œì§€ìƒ‰ */
        }
        .bg-custom {
            background-color: var(--custom-color);
        }
        .text-custom {
            color: var(--custom-color);
        }
        .border-custom {
            border-color: var(--custom-color);
        }
        .focus\:border-custom:focus {
            border-color: var(--custom-color);
        }
        .focus\:ring-custom:focus {
            box-shadow: 0 0 0 3px rgba(255, 165, 0, 0.5);
        }
        .button {
            display: inline-block;
            padding: 10px 20px;
            background-color: #e65802;
            color: black;
            text-decoration: none;
            border-radius: 5px;
            text-align: center;
        }
        .button:hover {
            background-color: #FFA500;
        }

        /* ë‹¤í¬ëª¨ë“œ í† ê¸€ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        #darkModeToggle {
            transition: all 0.3s ease;
        }
        #darkModeToggle:hover {
            transform: rotate(15deg);
        }
        .dark #darkModeToggle:hover {
            transform: rotate(-15deg);
        }

        /* ë‹¤í¬ëª¨ë“œ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
        .dark {
            color-scheme: dark;
        }

        .dark body {
            background-color: #121212 !important;
            color: #ffffff !important;
        }

        .dark .bg-orange-50,
        .dark .bg-orange-100,
        .dark .bg-white {
            background-color: #1e1e1e !important;
            color: #f0f0f0 !important;
        }

        .dark h1, .dark h2, .dark h3, .dark p, 
        .dark label, .dark text, .dark div {
            color: #f0f0f0 !important;
        }

        .dark input, .dark select, .dark textarea {
            background-color: #2d2d2d !important;
            color: #ffffff !important;
            border-color: #444444 !important;
        }

        .dark .shadow, .dark .shadow-lg, .dark .shadow-sm {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5) !important;
        }

        .dark table th {
            background-color: #2d2d2d !important;
            color: #f0f0f0 !important;
        }

        .dark table td {
            color: #f0f0f0 !important;
        }

        .dark .bg-green-50 {
            background-color: rgba(22, 101, 52, 0.3) !important;
        }

        .dark .bg-red-50 {
            background-color: rgba(153, 27, 27, 0.3) !important;
        }

        /* ì‚¬ì´ë“œë°” ë‹¤í¬ëª¨ë“œ ìŠ¤íƒ€ì¼ */
        .dark aside.w-64 {
            background-color: #1f2937 !important; /* bg-gray-800ê³¼ ë™ì¼ */
        }

        .dark .button {
            background-color: #374151 !important; /* bg-gray-700ê³¼ ë™ì¼ */
            color: #f3f4f6 !important; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
        }

        .dark .button:hover {
            background-color: #4b5563 !important; /* bg-gray-600ê³¼ ë™ì¼ */
        }

        .dark .button.bg-yellow-500 {
            background-color: #4338ca !important; /* ì„ íƒëœ ë²„íŠ¼ì€ ì¸ë””ê³ -700ìœ¼ë¡œ */
            color: #f3f4f6 !important;
        }
    </style>
    
</head>
<body class="min-h-screen bg-orange-50 dark:bg-orange-100">
    <div class="flex h-screen overflow-hidden">
        <aside class="w-64 bg-orange-600 text-white dark:bg-orange-500">
            <a href="#" id="homeRefreshButton" class="block text-center p-2 hover:bg-orange-700 transition-all duration-300">
                <img src="nepesark_2-removebg-preview.png" alt="HOME" class="h-30 w-auto transition-transform duration-300 hover:scale-105" />
            </a>       
                    <a href="index.html" class="button w-full text-left bg-orange-500 text-black  mb-1">ğŸ“™ Parts ì¬ê³ ê´€ë¦¬</a>
                    <a href="Parts_ì…ì¶œê³ .html" class="button w-full text-left bg-yellow-500 hover:bg-yellow-500 text-black ">ğŸšš Parts ì…ì¶œê³  ì´ë ¥</a>
                    <a href="ì¬ê³ ëª©ë¡.html" class="button w-full text-left bg-orange-500 hover:bg-yellow-500 text-black ">ğŸ“Š ì¬ê³ ëª©ë¡ ê´€ë¦¬</a>
                </a>
            </nav>
        </aside>        <main class="flex-1 overflow-y-auto">
            <header class="bg-orange-100 shadow-sm dark:bg-orange-200">
                <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                    <div class="flex justify-between items-center">
                        <h1 class="text-2xl font-semibold text-orange-900 dark:text-orange-800">ì¥ë¹„ì†”ë£¨ì…˜ íŒŒíŠ¸ Board Parts ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
                        <div class="flex items-center space-x-4">
                            <!-- ë‹¤í¬ëª¨ë“œ í† ê¸€ ë²„íŠ¼ ì¶”ê°€ -->
                            <button id="darkModeToggle" class="rounded-full p-2 bg-orange-200 hover:bg-orange-300 dark:bg-orange-700 dark:hover:bg-orange-600 transition-colors">
                                <i id="moonIcon" class="fas fa-moon text-orange-800"></i>
                                <i id="sunIcon" class="fas fa-sun text-orange-800" style="display: none;"></i>
                            </button>
                            
                            <div class="relative">
                                <button class="!rounded-button flex items-center text-orange-700 hover:text-orange-900 dark:text-orange-600 dark:hover:text-orange-800">
                                    <i class="fas fa-bell text-xl"></i>
                                </button>
                                <span class="absolute -top-1 -right-1 bg-orange-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center">3</span>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <div class="flex">
                <div class="flex-1 max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-semibold">ì…ì¶œê³  ë‚´ì—­</h2>
                    <div class="flex items-end space-x-4">
                        <div class="relative">
                            <label for="itemNameFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">í’ˆëª… ê²€ìƒ‰</label>
                            <div class="relative">
                                <input 
                                    type="text" 
                                    id="itemNameFilter" 
                                    placeholder="í’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”..." 
                                    class="w-64 pl-10 pr-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"
                                >
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-search text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                        <button 
                            id="clearFilter" 
                            class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors dark:bg-gray-600 dark:hover:bg-gray-700 h-10"
                        >
                            <i class="fas fa-times mr-1"></i>ì´ˆê¸°í™”
                        </button>
                    </div>
                </div>                <table class="w-full border-collapse border border-gray-300">
                    <thead class="bg-orange-500 text-white dark:bg-orange-700">
                        <tr>
                            <th class="px-4 py-2 text-center">ë‚ ì§œ</th>
                            <th class="px-4 py-2 text-center">í’ˆëª©</th>
                            <th class="px-4 py-2 text-center">ì¹´í…Œê³ ë¦¬</th>
                            <th class="px-4 py-2 text-center">íƒ€ì…</th>
                            <th class="px-4 py-2 text-center">ìˆ˜ëŸ‰</th>
                            <th class="px-4 py-2 text-center">êµ¬ë§¤ì²˜</th>
                            <th class="px-4 py-2 text-center">êµ¬ë§¤ ê¸ˆì•¡</th>
                            <th class="px-4 py-2 text-center">ì„¤ë¹„êµ°</th>
                            <th class="px-4 py-2 text-center">Boardëª…</th>
                            <th class="px-4 py-2 text-center">S/N</th>
                            <th class="px-4 py-2 text-center">ì‘ì—…ì</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                    <!-- ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </tbody>
                </table>
                </div>
            </div>
        </main>
    </div>
    
    <!-- ì…ê³ /ì¶œê³  ì²˜ë¦¬ ëª¨ë‹¬ -->
    <div id="stockModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 w-96 max-w-md">
            <h2 id="stockModalTitle" class="text-lg font-semibold mb-4 dark:text-white">ì…ê³  ì²˜ë¦¬</h2>
            <form id="stockForm">
                <div class="mb-4">
                    <label for="stockLocation" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ìœ„ì¹˜</label>
                    <input type="text" id="stockLocation" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" required>
                </div>                <div class="mb-4">
                    <label for="stockName" class="block text-sm font-medium text-gray-700 dark:text-gray-300">í’ˆëª…</label>
                    <input type="text" id="stockName" list="stockNameList" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" required>
                    <datalist id="stockNameList">
                        <!-- í’ˆëª… ì˜µì…˜ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </datalist>
                </div>
                <div class="mb-4">
                    <label for="stockCategory" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ì¹´í…Œê³ ë¦¬</label>
                    <input type="text" id="stockCategory" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" placeholder="ì˜ˆ: PCB, IC, ì €í•­, ê¸°íƒ€" required>
                </div>
                <div class="mb-4">
                    <label for="stockAmount" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ìˆ˜ëŸ‰</label>
                    <input type="number" id="stockAmount" min="1" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" required>
                </div>
                <div class="mb-4">
                    <label for="stockDate" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ë‚ ì§œ</label>
                    <input type="date" id="stockDate" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" required>
                </div>
                <input type="hidden" id="stockType" value="ì…ê³ ">
                <div class="flex justify-end space-x-4">
                    <button type="button" id="stockCancelButton" class="px-4 py-2 bg-gray-300 dark:bg-gray-600 dark:text-white rounded-md hover:bg-gray-400 dark:hover:bg-gray-700">ì·¨ì†Œ</button>
                    <button type="submit" id="stockSubmitButton" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600">ì…ê³  ì²˜ë¦¬</button>
                </div>
            </form>
        </div>
    </div>
      <!-- ì…ê³  ì²˜ë¦¬ ëª¨ë‹¬ ì°½ -->
    <div id="importModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-40">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 w-3/4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold dark:text-white">ì…ê³  ì²˜ë¦¬</h2>
                <button id="closeImportModalBtn" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p class="mb-4 dark:text-gray-300">ì…ê³  ì²˜ë¦¬í•  ë¶€í’ˆì„ ë”ë¸” í´ë¦­í•˜ì„¸ìš”.</p>
            
            <!-- ê²€ìƒ‰ í•„í„° -->
            <div class="flex space-x-4 mb-4">
                <div class="flex-1">
                    <label for="importNameFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">í’ˆëª… ê²€ìƒ‰</label>
                    <div class="relative">
                        <input 
                            type="text" 
                            id="importNameFilter" 
                            placeholder="í’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”..." 
                            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"
                        >
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                    </div>
                </div>
                <div class="flex-1">
                    <label for="importCategoryFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰</label>
                    <select id="importCategoryFilter" class="w-full py-2 px-3 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        <option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
                        <!-- ì¹´í…Œê³ ë¦¬ ì˜µì…˜ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </select>
                </div>
                <div class="flex items-end">
                    <button 
                        id="clearImportFilter" 
                        class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors dark:bg-gray-600 dark:hover:bg-gray-700"
                    >
                        <i class="fas fa-times mr-1"></i>ì´ˆê¸°í™”
                    </button>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                    <thead>
                        <tr>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ìœ„ì¹˜</th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">í’ˆëª…</th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">êµ¬ë§¤ì²˜</th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ì¹´í…Œê³ ë¦¬</th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ìµœì†Œ ì¬ê³ </th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ì…ê³ ì¼</th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">í˜„ì¬ ì¬ê³ </th>
                        </tr>
                    </thead>
                    <tbody id="importTableBody">
                        <!-- ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ì…ê³ ëŸ‰ ì…ë ¥ ëª¨ë‹¬ ì°½ -->
    <div id="importAmountModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 w-96">
            <h2 class="text-lg font-semibold mb-4 dark:text-white">ì…ê³ ëŸ‰ ì…ë ¥</h2>
            <p id="selectedPartImportInfo" class="mb-4 dark:text-gray-300">ì„ íƒí•œ ë¶€í’ˆ: <span class="font-medium"></span></p>
            <p id="currentStockImportInfo" class="mb-4 dark:text-gray-300">í˜„ì¬ ì¬ê³ : <span class="font-medium"></span></p>
            <p id="locationImportInfo" class="mb-4 dark:text-gray-300">ìœ„ì¹˜: <span class="font-medium"></span></p>
              <div class="mb-4">
                <label for="importAmount" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ì…ê³ ëŸ‰</label>
                <input type="number" id="importAmount" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" min="1" step="1" required>
            </div>
            
            <div class="mb-4">
                <label for="importCompany" class="block text-sm font-medium text-gray-700 dark:text-gray-300">êµ¬ë§¤ì²˜</label>
                <input type="text" id="importCompany" list="importCompanyList" autocomplete="off" 
                       class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" 
                       placeholder="ì˜ˆ: ì‚¼ì„±ì „ì">
                <datalist id="importCompanyList"></datalist>
            </div>
            
            <div class="mb-4">
                <label for="importPurchasePrice" class="block text-sm font-medium text-gray-700 dark:text-gray-300">êµ¬ë§¤ ê¸ˆì•¡</label>
                <input type="number" id="importPurchasePrice" 
                       class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" 
                       min="0" step="1" placeholder="ì˜ˆ: 50000">
            </div>
            
            <div class="flex justify-end space-x-4">
                <button type="button" id="cancelImportBtn" class="px-4 py-2 bg-gray-300 dark:bg-gray-600 dark:text-white rounded-md hover:bg-gray-400 dark:hover:bg-gray-700">ì·¨ì†Œ</button>
                <button type="button" id="confirmImportBtn" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600">í™•ì¸</button>
            </div>
        </div>
    </div>    <!-- ì¶œê³  ì²˜ë¦¬ ëª¨ë‹¬ ì°½ -->
    <div id="exportModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-40">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 w-3/4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold dark:text-white">ì¶œê³  ì²˜ë¦¬</h2>
                <button id="closeExportModalBtn" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p class="mb-4 dark:text-gray-300">ì¶œê³  ì²˜ë¦¬í•  ë¶€í’ˆì„ ë”ë¸” í´ë¦­í•˜ì„¸ìš”.</p>
            
            <!-- ê²€ìƒ‰ í•„í„° -->
            <div class="flex space-x-4 mb-4">
                <div class="flex-1">
                    <label for="exportNameFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">í’ˆëª… ê²€ìƒ‰</label>
                    <div class="relative">
                        <input 
                            type="text" 
                            id="exportNameFilter" 
                            placeholder="í’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”..." 
                            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"
                        >
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                    </div>
                </div>
                <div class="flex-1">
                    <label for="exportCategoryFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰</label>
                    <select id="exportCategoryFilter" class="w-full py-2 px-3 border border-gray-300 rounded-lg shadow-sm focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        <option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
                        <!-- ì¹´í…Œê³ ë¦¬ ì˜µì…˜ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </select>
                </div>
                <div class="flex items-end">
                    <button 
                        id="clearExportFilter" 
                        class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors dark:bg-gray-600 dark:hover:bg-gray-700"
                    >
                        <i class="fas fa-times mr-1"></i>ì´ˆê¸°í™”
                    </button>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                    <thead>
                        <tr>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ìœ„ì¹˜</th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">í’ˆëª…</th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">êµ¬ë§¤ì²˜</th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ì¹´í…Œê³ ë¦¬</th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ìµœì†Œ ì¬ê³ </th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ì…ê³ ì¼</th>
                            <th class="px-4 py-2 text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">í˜„ì¬ ì¬ê³ </th>
                        </tr>
                    </thead>
                    <tbody id="exportTableBody">
                        <!-- ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>    <!-- ì¶œê³ ëŸ‰ ì…ë ¥ ëª¨ë‹¬ ì°½ -->
    <div id="exportAmountModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 w-96 max-w-lg">
            <h2 class="text-lg font-semibold mb-4 dark:text-white">ì¶œê³ ëŸ‰ ì…ë ¥</h2>
            <p id="selectedPartExportInfo" class="mb-4 dark:text-gray-300">ì„ íƒí•œ ë¶€í’ˆ: <span class="font-medium"></span></p>
            <p id="currentStockExportInfo" class="mb-4 dark:text-gray-300">í˜„ì¬ ì¬ê³ : <span class="font-medium"></span></p>
            <p id="locationExportInfo" class="mb-4 dark:text-gray-300">ìœ„ì¹˜: <span class="font-medium"></span></p>
            
            <div class="mb-4">
                <label for="exportAmount" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ì¶œê³ ëŸ‰</label>
                <input type="number" id="exportAmount" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" min="1" step="1" required>
            </div>
            
            <div class="mb-4">
                <label for="exportEquipmentGroup" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ì„¤ë¹„êµ°</label>
                <input type="text" id="exportEquipmentGroup" list="exportEquipmentGroupList" autocomplete="off" 
                       class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" 
                       placeholder="ì˜ˆ: SMTë¼ì¸">
                <datalist id="exportEquipmentGroupList"></datalist>
            </div>
            
            <div class="mb-4">
                <label for="exportBoardName" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Boardëª…</label>
                <input type="text" id="exportBoardName" list="exportBoardNameList" autocomplete="off" 
                       class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" 
                       placeholder="ì˜ˆ: MainBoard_V1.2">
                <datalist id="exportBoardNameList"></datalist>
            </div>
            
            <div class="mb-4">
                <label for="exportSerialNumber" class="block text-sm font-medium text-gray-700 dark:text-gray-300">S/N</label>
                <input type="text" id="exportSerialNumber" list="exportSerialNumberList" autocomplete="off" 
                       class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" 
                       placeholder="ì˜ˆ: SN2025060001">
                <datalist id="exportSerialNumberList"></datalist>
            </div>
            
            <div class="mb-4">
                <label for="exportOperator" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ì‘ì—…ì</label>
                <input type="text" id="exportOperator" list="exportOperatorList" autocomplete="off" 
                       class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" 
                       placeholder="ì˜ˆ: í™ê¸¸ë™">
                <datalist id="exportOperatorList"></datalist>
            </div>
            
            <div class="flex justify-end space-x-4">
                <button type="button" id="cancelExportBtn" class="px-4 py-2 bg-gray-300 dark:bg-gray-600 dark:text-white rounded-md hover:bg-gray-400 dark:hover:bg-gray-700">ì·¨ì†Œ</button>
                <button type="button" id="confirmExportBtn" class="px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600">í™•ì¸</button>
            </div>
        </div>
    </div>
    <script>
        const stockChart = echarts.init(document.getElementById('stockChart'));
        const flowChart = echarts.init(document.getElementById('flowChart'));
        stockChart.setOption({
            animation: false,
            tooltip: {
                trigger: 'item'
            },
            series: [{
                type: 'pie',
                radius: ['40%', '70%'],
                data: [
                    { value: 45, name: 'PCB' },
                    { value: 25, name: 'IC' },
                    { value: 15, name: 'ì €í•­' },
                    { value: 15, name: 'ê¸°íƒ€' }
                ],
                emphasis: {
                    itemStyle: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }]
        });
        flowChart.setOption({
            animation: false,
            tooltip: {
                trigger: 'axis'
            },
            xAxis: {
                type: 'category',
                data: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”']
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                name: 'ì…ê³ ',
                type: 'bar',
                data: [120, 200, 150, 80, 70, 110],
                color: '#FFA500'
            }, {
                name: 'ì¶œê³ ',
                type: 'bar',
                data: [100, 180, 140, 90, 60, 90],
                color: '#FF7F50'
            }]
        });
        window.addEventListener('resize', function() {
            stockChart.resize();
            flowChart.resize();
        });
    </script>
    <script defer>
        const modal = document.getElementById('modal');
        const openModalButton = document.getElementById('openModalButton');
        const cancelButton = document.getElementById('cancelButton');
        const partForm = document.getElementById('partForm');

        openModalButton.addEventListener('click', () => {
            modal.classList.remove('hidden');
        });

        cancelButton.addEventListener('click', () => {
            modal.classList.add('hidden');
        });

        partForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = {
                location: document.getElementById('location').value,
                name: document.getElementById('name').value,
                inDate: document.getElementById('inDate').value,
                inQuantity: document.getElementById('inQuantity').value,
                outDate: document.getElementById('outDate').value,
                outQuantity: document.getElementById('outQuantity').value,
            };
            console.log('ë“±ë¡ëœ ë°ì´í„°:', formData);
            modal.classList.add('hidden');
            partForm.reset();
        });
    </script>
    <script>
        // ë‹¤í¬ëª¨ë“œ í† ê¸€ ë²„íŠ¼ ì´ˆê¸°í™”
        const darkModeToggle = document.getElementById('darkModeToggle');
        const moonIcon = document.getElementById('moonIcon');
        const sunIcon = document.getElementById('sunIcon');

        if (darkModeToggle) {
            // í˜„ì¬ í…Œë§ˆ ìƒíƒœì— ë”°ë¼ ì•„ì´ì½˜ ì„¤ì •
            const isDarkMode = document.documentElement.classList.contains('dark');
            if (isDarkMode) {
                moonIcon.style.display = 'none';
                sunIcon.style.display = 'inline-block';
            } else {
                moonIcon.style.display = 'inline-block';
                sunIcon.style.display = 'none';
            }
            
            // í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì„¤ì •
            darkModeToggle.onclick = function() {
                console.log('ë‹¤í¬ëª¨ë“œ í† ê¸€ ë²„íŠ¼ í´ë¦­ë¨');
                
                // í˜„ì¬ í…Œë§ˆ í™•ì¸
                const isDarkMode = document.documentElement.classList.contains('dark');
                console.log('í˜„ì¬ ë‹¤í¬ëª¨ë“œ ìƒíƒœ:', isDarkMode);
                
                if (isDarkMode) {
                    // ë‹¤í¬ëª¨ë“œ -> ë¼ì´íŠ¸ëª¨ë“œ ì „í™˜
                    document.documentElement.classList.remove('dark');
                    localStorage.theme = 'light';
                    console.log('ë¼ì´íŠ¸ ëª¨ë“œë¡œ ì „í™˜ë¨');
                    
                    // ì•„ì´ì½˜ ì „í™˜: ë‹¬ í‘œì‹œ, í•´ ìˆ¨ê¹€
                    moonIcon.style.display = 'inline-block';
                    sunIcon.style.display = 'none';
                } else {
                    // ë¼ì´íŠ¸ëª¨ë“œ -> ë‹¤í¬ëª¨ë“œ ì „í™˜
                    document.documentElement.classList.add('dark');
                    localStorage.theme = 'dark';
                    console.log('ë‹¤í¬ ëª¨ë“œë¡œ ì „í™˜ë¨');
                    
                    // ì•„ì´ì½˜ ì „í™˜: ë‹¬ ìˆ¨ê¹€, í•´ í‘œì‹œ
                    moonIcon.style.display = 'none';
                    sunIcon.style.display = 'inline-block';
                }
            };
        }
    </script>
    <script>
        // "Parts ì¬ê³  ê´€ë¦¬" í´ë¦­ ì‹œ ì´ë™
        document.querySelector("span:contains('Parts ì¬ê³  ê´€ë¦¬')").parentElement.addEventListener('click', function() {
            window.location.href = 'stock_management.html'; // ì¬ê³  ê´€ë¦¬ í˜ì´ì§€ë¡œ ì´ë™
        });

        // "Parts ì…ì¶œê³  ê´€ë¦¬" í´ë¦­ ì‹œ ì´ë™
        document.querySelector("span:contains('Parts ì…ì¶œê³  ê´€ë¦¬')").parentElement.addEventListener('click', function() {
            window.location.href = 'Parts_ì…ì¶œê³ .html'; // ì…ì¶œê³  ê´€ë¦¬ í˜ì´ì§€ë¡œ ì´ë™
        });    </script>
      <!-- ê¸€ë¡œë²Œ í•¨ìˆ˜ ì •ì˜ -->
    <script>
        // ì „ì—­ ë³€ìˆ˜ë¡œ ì›ë³¸ ë°ì´í„° ì €ì¥
        let originalHistoryData = [];
        
        // ë°ì´í„° ë Œë”ë§ í•¨ìˆ˜ (ê¸€ë¡œë²Œ ìŠ¤ì½”í”„)
        function renderHistoryData(data) {
            const historyTableBody = document.getElementById('historyTableBody');
            
            // í…Œì´ë¸” ì´ˆê¸°í™”
            historyTableBody.innerHTML = '';            // ë°ì´í„°ê°€ ì—†ì„ ê²½ìš°
            if (!data || data.length === 0) {
                const emptyRow = document.createElement('tr');
                emptyRow.innerHTML = `
                    <td colspan="11" class="border border-gray-300 px-4 py-4 text-center text-gray-500 dark:text-gray-400">
                        ${originalHistoryData.length === 0 ? 'ì…ì¶œê³  ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.' : 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.'}
                    </td>
                `;
                historyTableBody.appendChild(emptyRow);
                return;
            }
            
            // ë°ì´í„° ì¶œë ¥
            data.forEach(item => {
                console.log('í…Œì´ë¸” ë Œë”ë§ ë°ì´í„°:', item); // ë””ë²„ê¹…ìš©
                const row = document.createElement('tr');
                
                // ì…ê³ /ì¶œê³ ì— ë”°ë¼ ë°°ê²½ìƒ‰ ì„¤ì •
                if (item.type === 'ì…ê³ ') {
                    row.classList.add('bg-green-50');
                } else if (item.type === 'ì¶œê³ ') {
                    row.classList.add('bg-red-50');
                }
                
                row.innerHTML = `
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.date || '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.name || '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.category || '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.type || '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.amount || '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.company || '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.purchasePrice ? 'â‚©' + Number(item.purchasePrice).toLocaleString() : '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.equipmentGroup || '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.boardName || '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.serialNumber || '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${item.operator || '-'}</td>
                `;
                
                historyTableBody.appendChild(row);
            });
        }
        
        // ì…ê³  í…Œì´ë¸” ë Œë”ë§ í•¨ìˆ˜
        function renderImportTable(data) {
            const importTableBody = document.getElementById('importTableBody');
            importTableBody.innerHTML = '';
            
            if (!data || data.length === 0) {
                const emptyRow = document.createElement('tr');
                emptyRow.innerHTML = `
                    <td colspan="7" class="py-4 px-4 text-center text-gray-500 dark:text-gray-400">
                        ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
                    </td>
                `;
                importTableBody.appendChild(emptyRow);
                return;
            }
            
            data.forEach((part, index) => {
                const row = document.createElement('tr');
                row.classList.add('border-b', 'hover:bg-orange-50', 'dark:hover:bg-gray-700', 'cursor-pointer');
                row.setAttribute('data-index', index);
                
                row.innerHTML = `
                    <td class="py-2 px-4 text-center dark:text-white">${part.location || ''}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.name || ''}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.company || ''}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.category || ''}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.minStock || '0'}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.inDate || ''}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.currentStock || '0'}</td>
                `;
                  // ë”ë¸” í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                row.addEventListener('dblclick', async () => {
                    const selectedPart = part;
                    
                    // ì„ íƒëœ ë¶€í’ˆ ì •ë³´ í‘œì‹œ
                    document.getElementById('selectedPartImportInfo').querySelector('span').textContent = selectedPart.name;
                    document.getElementById('currentStockImportInfo').querySelector('span').textContent = selectedPart.currentStock || '0';
                    document.getElementById('locationImportInfo').querySelector('span').textContent = selectedPart.location || 'ìœ„ì¹˜ ì—†ìŒ';
                    
                    // ì…ê³ ëŸ‰ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                    document.getElementById('importAmount').value = '1';
                    document.getElementById('importCompany').value = '';
                    document.getElementById('importPurchasePrice').value = '';
                    
                    // êµ¬ë§¤ì²˜ ë°ì´í„°ë¦¬ìŠ¤íŠ¸ ë¡œë“œ
                    try {
                        const dbDataResult = await window.partsAPI.getDbData();
                        if (dbDataResult.success && dbDataResult.data.companies) {
                            const companyList = document.getElementById('importCompanyList');
                            companyList.innerHTML = '';
                            
                            dbDataResult.data.companies.forEach(company => {
                                const option = document.createElement('option');
                                option.value = company;
                                companyList.appendChild(option);
                            });
                        }
                    } catch (error) {
                        console.warn('êµ¬ë§¤ì²˜ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                    }
                    
                    // ì„ íƒëœ ë¶€í’ˆ ì •ë³´ ì €ì¥
                    window.selectedImportPart = selectedPart;
                    
                    // ì…ê³ ëŸ‰ ì…ë ¥ ëª¨ë‹¬ í‘œì‹œ
                    document.getElementById('importAmountModal').classList.remove('hidden');
                });
                
                importTableBody.appendChild(row);
            });
        }
        
        // ì¶œê³  í…Œì´ë¸” ë Œë”ë§ í•¨ìˆ˜
        function renderExportTable(data) {
            const exportTableBody = document.getElementById('exportTableBody');
            exportTableBody.innerHTML = '';
            
            if (!data || data.length === 0) {
                const emptyRow = document.createElement('tr');
                emptyRow.innerHTML = `
                    <td colspan="7" class="py-4 px-4 text-center text-gray-500 dark:text-gray-400">
                        ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
                    </td>
                `;
                exportTableBody.appendChild(emptyRow);
                return;
            }
            
            data.forEach((part, index) => {
                const row = document.createElement('tr');
                row.classList.add('border-b', 'hover:bg-orange-50', 'dark:hover:bg-gray-700', 'cursor-pointer');
                row.setAttribute('data-index', index);
                
                row.innerHTML = `
                    <td class="py-2 px-4 text-center dark:text-white">${part.location || ''}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.name || ''}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.company || ''}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.category || ''}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.minStock || '0'}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.inDate || ''}</td>
                    <td class="py-2 px-4 text-center dark:text-white">${part.currentStock || '0'}</td>
                `;
                  // ë”ë¸” í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                row.addEventListener('dblclick', async () => {
                    const selectedPart = part;
                    
                    // ì„ íƒëœ ë¶€í’ˆ ì •ë³´ í‘œì‹œ
                    document.getElementById('selectedPartExportInfo').querySelector('span').textContent = selectedPart.name;
                    document.getElementById('currentStockExportInfo').querySelector('span').textContent = selectedPart.currentStock || '0';
                    document.getElementById('locationExportInfo').querySelector('span').textContent = selectedPart.location || 'ìœ„ì¹˜ ì—†ìŒ';
                    
                    // ì¶œê³ ëŸ‰ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                    const exportAmountInput = document.getElementById('exportAmount');
                    exportAmountInput.value = '1';
                    exportAmountInput.max = parseInt(selectedPart.currentStock || 0);
                    
                    // ìƒˆë¡œìš´ í•„ë“œë“¤ ì´ˆê¸°í™”
                    document.getElementById('exportEquipmentGroup').value = '';
                    document.getElementById('exportBoardName').value = '';
                    document.getElementById('exportSerialNumber').value = '';
                    document.getElementById('exportOperator').value = '';
                    
                    // ìë™ì™„ì„± ë°ì´í„° ë¡œë“œ
                    try {
                        const dbDataResult = await window.partsAPI.getDbData();
                        if (dbDataResult.success && dbDataResult.data) {
                            // ì„¤ë¹„êµ° ë°ì´í„°ë¦¬ìŠ¤íŠ¸
                            if (dbDataResult.data.equipmentGroups) {
                                const equipmentGroupList = document.getElementById('exportEquipmentGroupList');
                                equipmentGroupList.innerHTML = '';
                                dbDataResult.data.equipmentGroups.forEach(group => {
                                    const option = document.createElement('option');
                                    option.value = group;
                                    equipmentGroupList.appendChild(option);
                                });
                            }
                            
                            // Boardëª… ë°ì´í„°ë¦¬ìŠ¤íŠ¸
                            if (dbDataResult.data.boardNames) {
                                const boardNameList = document.getElementById('exportBoardNameList');
                                boardNameList.innerHTML = '';
                                dbDataResult.data.boardNames.forEach(board => {
                                    const option = document.createElement('option');
                                    option.value = board;
                                    boardNameList.appendChild(option);
                                });
                            }
                            
                            // S/N ë°ì´í„°ë¦¬ìŠ¤íŠ¸
                            if (dbDataResult.data.serialNumbers) {
                                const serialNumberList = document.getElementById('exportSerialNumberList');
                                serialNumberList.innerHTML = '';
                                dbDataResult.data.serialNumbers.forEach(sn => {
                                    const option = document.createElement('option');
                                    option.value = sn;
                                    serialNumberList.appendChild(option);
                                });
                            }
                            
                            // ì‘ì—…ì ë°ì´í„°ë¦¬ìŠ¤íŠ¸
                            if (dbDataResult.data.operators) {
                                const operatorList = document.getElementById('exportOperatorList');
                                operatorList.innerHTML = '';
                                dbDataResult.data.operators.forEach(operator => {
                                    const option = document.createElement('option');
                                    option.value = operator;
                                    operatorList.appendChild(option);
                                });
                            }
                        }
                    } catch (error) {
                        console.warn('ìë™ì™„ì„± ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                    }
                    
                    // ì„ íƒëœ ë¶€í’ˆ ì •ë³´ ì €ì¥
                    window.selectedExportPart = selectedPart;
                    
                    // ì¶œê³ ëŸ‰ ì…ë ¥ ëª¨ë‹¬ í‘œì‹œ
                    document.getElementById('exportAmountModal').classList.remove('hidden');
                });
                
                exportTableBody.appendChild(row);
            });
        }
        
        // ì…ê³  í•„í„°ë§ í•¨ìˆ˜
        function filterImportData() {
            const nameFilter = document.getElementById('importNameFilter').value.toLowerCase().trim();
            const categoryFilter = document.getElementById('importCategoryFilter').value;
            
            if (!window.allImportData) return;
            
            let filteredData = window.allImportData;
            
            // í’ˆëª… í•„í„°ë§
            if (nameFilter) {
                filteredData = filteredData.filter(item => 
                    item.name && item.name.toLowerCase().includes(nameFilter)
                );
            }
            
            // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
            if (categoryFilter) {
                filteredData = filteredData.filter(item => 
                    item.category === categoryFilter
                );
            }
            
            renderImportTable(filteredData);
        }
        
        // ì¶œê³  í•„í„°ë§ í•¨ìˆ˜
        function filterExportData() {
            const nameFilter = document.getElementById('exportNameFilter').value.toLowerCase().trim();
            const categoryFilter = document.getElementById('exportCategoryFilter').value;
            
            if (!window.allExportData) return;
            
            let filteredData = window.allExportData;
            
            // í’ˆëª… í•„í„°ë§
            if (nameFilter) {
                filteredData = filteredData.filter(item => 
                    item.name && item.name.toLowerCase().includes(nameFilter)
                );
            }
            
            // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
            if (categoryFilter) {
                filteredData = filteredData.filter(item => 
                    item.category === categoryFilter
                );
            }
            
            renderExportTable(filteredData);
        }
        
        // ì…ê³  í•„í„° ì´ë²¤íŠ¸ ì„¤ì •
        function setupImportFilters() {
            const nameFilter = document.getElementById('importNameFilter');
            const categoryFilter = document.getElementById('importCategoryFilter');
            const clearFilter = document.getElementById('clearImportFilter');
            
            nameFilter.addEventListener('input', filterImportData);
            categoryFilter.addEventListener('change', filterImportData);
            
            clearFilter.addEventListener('click', () => {
                nameFilter.value = '';
                categoryFilter.value = '';
                renderImportTable(window.allImportData);
            });
        }
        
        // ì¶œê³  í•„í„° ì´ë²¤íŠ¸ ì„¤ì •
        function setupExportFilters() {
            const nameFilter = document.getElementById('exportNameFilter');
            const categoryFilter = document.getElementById('exportCategoryFilter');
            const clearFilter = document.getElementById('clearExportFilter');
            
            nameFilter.addEventListener('input', filterExportData);
            categoryFilter.addEventListener('change', filterExportData);
            
            clearFilter.addEventListener('click', () => {
                nameFilter.value = '';
                categoryFilter.value = '';
                renderExportTable(window.allExportData);
            });
        }
    </script>
    
    <script>        
        document.addEventListener('DOMContentLoaded', async () => {
            // ê¸°ì¡´ ì½”ë“œ...
            
            // ë¡œê³  ì´ë¯¸ì§€ í´ë¦­ ì‹œ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
            const homeRefreshButton = document.getElementById('homeRefreshButton');
            if (homeRefreshButton) {
                homeRefreshButton.addEventListener('click', (e) => {
                    e.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë°©ì§€
                    console.log('í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨');
                    window.location.reload(true); // ìºì‹œë¥¼ ë¬´ì‹œí•˜ê³  ì™„ì „íˆ ìƒˆë¡œê³ ì¹¨
                });
            }
            
            // ê²€ìƒ‰ í•„í„° ê¸°ëŠ¥ ì´ˆê¸°í™”
            function initializeSearchFilter() {
                const itemNameFilter = document.getElementById('itemNameFilter');
                const clearFilter = document.getElementById('clearFilter');
                
                if (itemNameFilter) {
                    // ì‹¤ì‹œê°„ ê²€ìƒ‰ (ì…ë ¥í•  ë•Œë§ˆë‹¤ í•„í„°ë§)
                    itemNameFilter.addEventListener('input', function() {
                        const searchTerm = this.value.toLowerCase().trim();
                        filterHistoryData(searchTerm);
                    });
                }
                
                if (clearFilter) {
                    // ì´ˆê¸°í™” ë²„íŠ¼ í´ë¦­ ì‹œ
                    clearFilter.addEventListener('click', function() {
                        itemNameFilter.value = '';
                        filterHistoryData(''); // ëª¨ë“  ë°ì´í„° í‘œì‹œ
                    });
                }
            }
              // ë°ì´í„° í•„í„°ë§ í•¨ìˆ˜
            function filterHistoryData(searchTerm) {
                const historyTableBody = document.getElementById('historyTableBody');
                
                if (!originalHistoryData || originalHistoryData.length === 0) {
                    return;
                }
                
                // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ ëª¨ë“  ë°ì´í„° í‘œì‹œ
                if (!searchTerm) {
                    renderHistoryData(originalHistoryData);
                    return;
                }
                
                // í’ˆëª…ìœ¼ë¡œ í•„í„°ë§
                const filteredData = originalHistoryData.filter(item => {
                    return item.name && item.name.toLowerCase().includes(searchTerm);
                });
                
                renderHistoryData(filteredData);
            }
              // ì…ê³ /ì¶œê³  ëª¨ë‹¬ ì²˜ë¦¬ ì´ˆê¸°í™”
            function initializeStockModal() {
                const stockModal = document.getElementById('stockModal');
                const stockModalTitle = document.getElementById('stockModalTitle');
                const stockSubmitButton = document.getElementById('stockSubmitButton');
                const stockType = document.getElementById('stockType');
                const stockForm = document.getElementById('stockForm');
                const stockCancelButton = document.getElementById('stockCancelButton');
                const inStockButton = document.getElementById('inStockButton');
                const outStockButton = document.getElementById('outStockButton');
                const stockDate = document.getElementById('stockDate');
                const stockLocation = document.getElementById('stockLocation');
                const stockName = document.getElementById('stockName');
                
                // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
                const today = new Date().toISOString().split('T')[0];
                stockDate.value = today;
                
                // ì¬ê³  ë°ì´í„° ì €ì¥ìš© ë³€ìˆ˜
                let inventoryData = [];
                  // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¬ê³  ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                async function loadInventoryData() {
                    try {
                        const result = await window.partsAPI.getExcelData();
                        if (result.success) {
                            inventoryData = result.data;
                            console.log('ì¬ê³  ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', inventoryData.length, 'ê°œ í•­ëª©');
                            
                            // í’ˆëª… datalist ì±„ìš°ê¸°
                            const stockNameList = document.getElementById('stockNameList');
                            stockNameList.innerHTML = '';
                            
                            // ì¤‘ë³µ ì œê±°ëœ í’ˆëª… ëª©ë¡ ìƒì„±
                            const uniqueNames = [...new Set(inventoryData.map(item => item.name).filter(name => name))];
                            
                            uniqueNames.forEach(name => {
                                const option = document.createElement('option');
                                option.value = name;
                                stockNameList.appendChild(option);
                            });
                            
                            console.log('í’ˆëª… datalistì—', uniqueNames.length, 'ê°œ í•­ëª© ì¶”ê°€');
                        }
                    } catch (error) {
                        console.error('ì¬ê³  ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                    }
                }
                
                // í’ˆëª… ì…ë ¥ ì‹œ ìœ„ì¹˜ ìë™ ì±„ìš°ê¸°
                stockName.addEventListener('input', function() {
                    const inputName = this.value.trim();
                    
                    if (inputName && inventoryData.length > 0) {
                        // í’ˆëª…ìœ¼ë¡œ ì¬ê³  ë°ì´í„°ì—ì„œ ê²€ìƒ‰ (ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´)
                        const matchedItem = inventoryData.find(item => 
                            item.name && item.name.toString().toLowerCase() === inputName.toLowerCase()
                        );
                        
                        if (matchedItem && matchedItem.location) {
                            stockLocation.value = matchedItem.location;
                            console.log(`í’ˆëª… "${inputName}"ì— ëŒ€í•œ ìœ„ì¹˜ "${matchedItem.location}" ìë™ ì…ë ¥`);
                        } else {
                            // ì¼ì¹˜í•˜ëŠ” í•­ëª©ì´ ì—†ìœ¼ë©´ ìœ„ì¹˜ í•„ë“œ ë¹„ìš°ê¸°
                            stockLocation.value = '';
                        }
                    } else {
                        stockLocation.value = '';
                    }
                });
                  // ì¬ê³  ë°ì´í„° ì´ˆê¸° ë¡œë“œ
                loadInventoryData();
                  // ì…ê³  ë²„íŠ¼ í´ë¦­ - ìƒˆë¡œìš´ ëª¨ë‹¬ ë°©ì‹
                if (inStockButton) {
                    inStockButton.addEventListener('click', async () => {
                        try {
                            // ì¬ê³  ë°ì´í„° ë¡œë“œ
                            const result = await window.partsAPI.getExcelData();
                            
                            if (result.success) {
                                // ì „ì²´ ë°ì´í„° ì €ì¥ (í•„í„°ë§ìš©)
                                window.allImportData = result.data;
                                
                                // ì¹´í…Œê³ ë¦¬ ì˜µì…˜ ìƒì„±
                                const importCategoryFilter = document.getElementById('importCategoryFilter');
                                importCategoryFilter.innerHTML = '<option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>';
                                
                                const uniqueCategories = [...new Set(result.data.map(item => item.category).filter(cat => cat))];
                                uniqueCategories.forEach(category => {
                                    const option = document.createElement('option');
                                    option.value = category;
                                    option.textContent = category;
                                    importCategoryFilter.appendChild(option);
                                });
                                
                                // ì´ˆê¸° í…Œì´ë¸” ë Œë”ë§
                                renderImportTable(result.data);
                                
                                // ê²€ìƒ‰ í•„í„° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                                setupImportFilters();
                                
                                // ì…ê³  ì²˜ë¦¬ ëª¨ë‹¬ í‘œì‹œ
                                document.getElementById('importModal').classList.remove('hidden');
                            } else {
                                console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', result.error);
                                alert('ë°ì´í„°ë¥¼ ë¡œë“œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                            }
                        } catch (error) {
                            console.error('ì…ê³  ì²˜ë¦¬ ëª¨ë‹¬ ì—´ê¸° ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                            alert('ì…ê³  ì²˜ë¦¬ ëª¨ë‹¬ì„ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                        }
                    });
                }
                
                // ì¶œê³  ë²„íŠ¼ í´ë¦­ - ìƒˆë¡œìš´ ëª¨ë‹¬ ë°©ì‹
                if (outStockButton) {
                    outStockButton.addEventListener('click', async () => {
                        try {
                            // ì¬ê³  ë°ì´í„° ë¡œë“œ
                            const result = await window.partsAPI.getExcelData();
                            
                            if (result.success) {
                                // ì „ì²´ ë°ì´í„° ì €ì¥ (í•„í„°ë§ìš©)
                                window.allExportData = result.data;
                                
                                // ì¹´í…Œê³ ë¦¬ ì˜µì…˜ ìƒì„±
                                const exportCategoryFilter = document.getElementById('exportCategoryFilter');
                                exportCategoryFilter.innerHTML = '<option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>';
                                
                                const uniqueCategories = [...new Set(result.data.map(item => item.category).filter(cat => cat))];
                                uniqueCategories.forEach(category => {
                                    const option = document.createElement('option');
                                    option.value = category;
                                    option.textContent = category;
                                    exportCategoryFilter.appendChild(option);
                                });
                                
                                // ì´ˆê¸° í…Œì´ë¸” ë Œë”ë§
                                renderExportTable(result.data);
                                
                                // ê²€ìƒ‰ í•„í„° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                                setupExportFilters();
                                
                                // ì¶œê³  ì²˜ë¦¬ ëª¨ë‹¬ í‘œì‹œ
                                document.getElementById('exportModal').classList.remove('hidden');
                            } else {
                                console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', result.error);
                                alert('ë°ì´í„°ë¥¼ ë¡œë“œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                            }
                        } catch (error) {
                            console.error('ì¶œê³  ì²˜ë¦¬ ëª¨ë‹¬ ì—´ê¸° ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                            alert('ì¶œê³  ì²˜ë¦¬ ëª¨ë‹¬ì„ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                        }
                    });
                }
                
                // ì·¨ì†Œ ë²„íŠ¼ í´ë¦­
                if (stockCancelButton) {
                    stockCancelButton.addEventListener('click', () => {
                        stockModal.classList.add('hidden');
                        stockForm.reset();
                        stockDate.value = today; // ë‚ ì§œ ë‹¤ì‹œ ì„¤ì •
                    });
                }
                
                // í¼ ì œì¶œ
                if (stockForm) {
                    stockForm.addEventListener('submit', async (e) => {
                        e.preventDefault();
                        
                        const formData = {
                            location: document.getElementById('stockLocation').value,
                            name: document.getElementById('stockName').value,
                            amount: document.getElementById('stockAmount').value,
                            date: document.getElementById('stockDate').value,
                            type: document.getElementById('stockType').value
                        };
                          try {
                            console.log('ì…ì¶œê³  ì²˜ë¦¬ ë°ì´í„°:', formData);
                            
                            // API í˜¸ì¶œë¡œ ë°ì´í„° ì €ì¥
                            const result = await window.partsAPI.addHistoryData(formData);
                            
                            if (result.success) {
                                console.log('ì…ì¶œê³  ì²˜ë¦¬ ì™„ë£Œ');
                                
                                // ëª¨ë‹¬ ë‹«ê¸° ë° í¼ ì´ˆê¸°í™”
                                stockModal.classList.add('hidden');
                                stockForm.reset();
                                stockDate.value = today;
                                
                                // ì´ë ¥ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ (ì„œë²„ì—ì„œ ë‹¤ì‹œ ê°€ì ¸ì™€ì„œ ì¤‘ë³µ ë°©ì§€)
                                const historyResult = await window.partsAPI.getHistoryData();
                                if (historyResult.success) {
                                    originalHistoryData = historyResult.data || [];
                                    renderHistoryData(originalHistoryData);
                                }
                                
                                alert(`${formData.type} ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                            } else {
                                alert(`${formData.type} ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${result.error}`);
                            }
                        } catch (error) {
                            console.error('ì…ì¶œê³  ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', error);
                            alert(`${formData.type} ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`);
                        }
                    });
                }
            }
            
            // ì…ì¶œê³  ì´ë ¥ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            try {
                console.log('ì…ì¶œê³  ì´ë ¥ ë°ì´í„° ë¡œë“œ ì‹œì‘');
                const historyResult = await window.partsAPI.getHistoryData();
                
                if (historyResult.success) {
                    console.log('ë°›ì€ ì´ë ¥ ë°ì´í„°:', historyResult.data);
                    
                    // ì›ë³¸ ë°ì´í„° ì €ì¥
                    originalHistoryData = historyResult.data || [];
                    
                    // ì´ˆê¸° ë°ì´í„° ë Œë”ë§
                    renderHistoryData(originalHistoryData);
                      // ê²€ìƒ‰ í•„í„° ì´ˆê¸°í™”
                    initializeSearchFilter();
                      // ì…ê³ /ì¶œê³  ëª¨ë‹¬ ì´ˆê¸°í™”
                    initializeStockModal();
                    
                    // ìƒˆ ë¶€í’ˆ ë“±ë¡ ëª¨ë‹¬ ì´ˆê¸°í™”
                    initializeNewPartModal();
                    
                    console.log('ì…ì¶œê³  ì´ë ¥ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
                } else {
                    console.error('ì…ì¶œê³  ì´ë ¥ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', historyResult.error);
                      // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ                const historyTableBody = document.getElementById('historyTableBody');
                    historyTableBody.innerHTML = `
                        <tr>
                            <td colspan="11" class="border border-gray-300 px-4 py-4 text-center text-red-500 dark:text-red-400">
                                ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${historyResult.error}
                            </td>
                        </tr>
                    `;
                }
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                  // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
                const historyTableBody = document.getElementById('historyTableBody');
                historyTableBody.innerHTML = `
                    <tr>
                        <td colspan="11" class="border border-gray-300 px-4 py-4 text-center text-red-500 dark:text-red-400">
                            ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message || error}
                        </td>
                    </tr>
                `;
            }
        });
    </script> 
    <script>
        // ëª¨ë‹¬ ë‹«ê¸° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë“¤
        document.getElementById('closeImportModalBtn').addEventListener('click', () => {
            document.getElementById('importModal').classList.add('hidden');
        });
        
        document.getElementById('closeExportModalBtn').addEventListener('click', () => {
            document.getElementById('exportModal').classList.add('hidden');
        });
        
        // ì…ê³ ëŸ‰ ì…ë ¥ ëª¨ë‹¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë“¤
        document.getElementById('cancelImportBtn').addEventListener('click', () => {
            document.getElementById('importAmountModal').classList.add('hidden');
        });
          document.getElementById('confirmImportBtn').addEventListener('click', async () => {
            try {
                const amount = parseInt(document.getElementById('importAmount').value);
                const company = document.getElementById('importCompany').value;
                const purchasePrice = document.getElementById('importPurchasePrice').value;
                
                if (isNaN(amount) || amount <= 0) {
                    alert('ìœ íš¨í•œ ì…ê³ ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                const selectedPart = window.selectedImportPart;
                if (!selectedPart) {
                    alert('ì„ íƒëœ ë¶€í’ˆì´ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                // í˜„ì¬ ì¬ê³  ì—…ë°ì´íŠ¸
                const currentStock = parseInt(selectedPart.currentStock || 0);
                const newStock = currentStock + amount;

                // ì…ì¶œê³  ì´ë ¥ ì¶”ê°€
                const historyData = {
                    location: selectedPart.location || '',
                    name: selectedPart.name,
                    category: selectedPart.category || '',
                    amount: amount,
                    date: new Date().toISOString().split('T')[0],
                    type: 'ì…ê³ ',
                    company: company,
                    purchasePrice: purchasePrice
                };
                
                console.log('ì…ê³  ì²˜ë¦¬ - ì„ íƒëœ ë¶€í’ˆ:', selectedPart);
                console.log('ì…ê³  ì²˜ë¦¬ - ìœ„ì¹˜ ì •ë³´:', selectedPart.location);
                console.log('ì…ê³  ì²˜ë¦¬ ë°ì´í„°:', historyData);
                
                // API í˜¸ì¶œë¡œ ì´ë ¥ ì¶”ê°€
                const result = await window.partsAPI.addHistoryData(historyData);
                
                if (result.success) {
                    // ì¬ê³  ì—…ë°ì´íŠ¸ë„ ìˆ˜í–‰
                    const updateResult = await window.partsAPI.updateStock({
                        name: selectedPart.name,
                        currentStock: newStock,
                        action: 'import',
                        amount: amount,
                        category: selectedPart.category
                    });
                    
                    if (updateResult.success) {
                        // ëª¨ë‹¬ ë‹«ê¸°
                        document.getElementById('importAmountModal').classList.add('hidden');
                        document.getElementById('importModal').classList.add('hidden');
                        
                        // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                        document.getElementById('importAmount').value = '';
                        document.getElementById('importCompany').value = '';
                        document.getElementById('importPurchasePrice').value = '';
                        
                        alert(`${selectedPart.name} ë¶€í’ˆì˜ ì¬ê³ ê°€ ${amount}ê°œ ì…ê³ ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                        
                        // ì´ë ¥ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ (ì„œë²„ì—ì„œ ë‹¤ì‹œ ê°€ì ¸ì™€ì„œ ì¤‘ë³µ ë°©ì§€)
                        const historyResult = await window.partsAPI.getHistoryData();
                        if (historyResult.success) {
                            originalHistoryData = historyResult.data || [];
                            renderHistoryData(originalHistoryData);
                        }
                    } else {
                        alert(`ì¬ê³  ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: ${updateResult.error}`);
                    }
                } else {
                    alert(`ì…ê³  ì²˜ë¦¬ ì‹¤íŒ¨: ${result.error}`);
                }            } catch (error) {
                console.error('ì…ê³  ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                alert(`ì…ê³  ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message || error}`);
            }
        });
          // ì¶œê³ ëŸ‰ ì…ë ¥ ëª¨ë‹¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë“¤
        document.getElementById('cancelExportBtn').addEventListener('click', () => {
            document.getElementById('exportAmountModal').classList.add('hidden');
            // ëª¨ë‹¬ ë‹«ì„ ë•Œ ìƒˆë¡œìš´ ì…ë ¥ í•„ë“œë“¤ ì´ˆê¸°í™”
            document.getElementById('exportEquipmentGroup').value = '';
            document.getElementById('exportBoardName').value = '';
            document.getElementById('exportSerialNumber').value = '';
            document.getElementById('exportOperator').value = '';
        });
        
        document.getElementById('confirmExportBtn').addEventListener('click', async () => {
            try {
                const amount = parseInt(document.getElementById('exportAmount').value);
                const equipmentGroup = document.getElementById('exportEquipmentGroup').value.trim();
                const boardName = document.getElementById('exportBoardName').value.trim();
                const serialNumber = document.getElementById('exportSerialNumber').value.trim();
                const operator = document.getElementById('exportOperator').value.trim();
                
                if (isNaN(amount) || amount <= 0) {
                    alert('ìœ íš¨í•œ ì¶œê³ ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                const selectedPart = window.selectedExportPart;
                if (!selectedPart) {
                    alert('ì„ íƒëœ ë¶€í’ˆì´ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                // í˜„ì¬ ì¬ê³  í™•ì¸
                const currentStock = parseInt(selectedPart.currentStock || 0);
                if (amount > currentStock) {
                    alert(`í˜„ì¬ ì¬ê³ (${currentStock}ê°œ)ë³´ë‹¤ ë§ì€ ìˆ˜ëŸ‰ì„ ì¶œê³ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
                    return;
                }
                
                // í˜„ì¬ ì¬ê³  ì—…ë°ì´íŠ¸
                const newStock = currentStock - amount;
                  // ì…ì¶œê³  ì´ë ¥ ì¶”ê°€ (ìƒˆë¡œìš´ í•„ë“œë“¤ í¬í•¨)
                const historyData = {
                    location: selectedPart.location || '',
                    name: selectedPart.name,
                    category: selectedPart.category || '',
                    amount: amount,
                    date: new Date().toISOString().split('T')[0],
                    type: 'ì¶œê³ ',
                    equipmentGroup: equipmentGroup,
                    boardName: boardName,
                    serialNumber: serialNumber,
                    operator: operator
                };
                
                console.log('ì¶œê³  ì²˜ë¦¬ - ì„ íƒëœ ë¶€í’ˆ:', selectedPart);
                console.log('ì¶œê³  ì²˜ë¦¬ - ìœ„ì¹˜ ì •ë³´:', selectedPart.location);
                console.log('ì¶œê³  ì²˜ë¦¬ ë°ì´í„°:', historyData);
                
                // API í˜¸ì¶œë¡œ ì´ë ¥ ì¶”ê°€
                const result = await window.partsAPI.addHistoryData(historyData);
                
                if (result.success) {
                    // ì¬ê³  ì—…ë°ì´íŠ¸ë„ ìˆ˜í–‰
                    const updateResult = await window.partsAPI.updateStock({
                        name: selectedPart.name,
                        currentStock: newStock,
                        action: 'export',
                        amount: amount,
                        category: selectedPart.category
                    });
                    
                    if (updateResult.success) {
                        // ëª¨ë‹¬ ë‹«ê¸°
                        document.getElementById('exportAmountModal').classList.add('hidden');
                        document.getElementById('exportModal').classList.add('hidden');
                        
                        // ì…ë ¥ í•„ë“œë“¤ ì´ˆê¸°í™”
                        document.getElementById('exportAmount').value = '';
                        document.getElementById('exportEquipmentGroup').value = '';
                        document.getElementById('exportBoardName').value = '';
                        document.getElementById('exportSerialNumber').value = '';
                        document.getElementById('exportOperator').value = '';
                        
                        alert(`${selectedPart.name} ë¶€í’ˆì˜ ì¬ê³ ì—ì„œ ${amount}ê°œê°€ ì¶œê³ ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                        
                        // ì´ë ¥ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                        const historyResult = await window.partsAPI.getHistoryData();
                        if (historyResult.success) {
                            originalHistoryData = historyResult.data || [];
                            renderHistoryData(originalHistoryData);
                        }
                    } else {
                        alert(`ì¬ê³  ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: ${updateResult.error}`);
                    }
                } else {
                    alert(`ì¶œê³  ì²˜ë¦¬ ì‹¤íŒ¨: ${result.error}`);
                }            } catch (error) {
                console.error('ì¶œê³  ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                alert(`ì¶œê³  ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message || error}`);
            }
        });
    </script>    <!-- ìƒˆ ë¶€í’ˆ ë“±ë¡ ëª¨ë‹¬ ì°½ -->
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-60">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 w-96 max-w-2xl max-h-screen overflow-y-auto">
            <h2 class="text-lg font-semibold mb-4 dark:text-white">ìƒˆ ë¶€í’ˆ ë“±ë¡</h2>
            <form id="partForm">
                <div class="mb-4">
                    <label for="inDate" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ì…ê³ ì¼</label>
                    <input type="date" id="inDate" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500">
                </div>
                <div class="mb-4">
                    <label for="location" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ìœ„ì¹˜</label>
                    <input type="text" id="location" list="locationList" autocomplete="off" 
                           class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500 editable-input"
                           style="cursor: text;" required>
                    <datalist id="locationList"></datalist>
                </div>
                
                <div class="mb-4">
                    <label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300">í’ˆëª…</label>
                    <input type="text" id="name" list="nameList" autocomplete="off" 
                           class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500 editable-input"
                           style="cursor: text;" required>
                    <datalist id="nameList"></datalist>
                </div>
                
                <div class="mb-4">
                    <label for="company" class="block text-sm font-medium text-gray-700 dark:text-gray-300">êµ¬ë§¤ì²˜</label>
                    <input type="text" id="company" list="companyList" autocomplete="off" 
                           class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500 editable-input"
                           style="cursor: text;" required>
                    <datalist id="companyList"></datalist>
                </div>
                <div class="mb-4">
                    <label for="category" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ì¹´í…Œê³ ë¦¬</label>
                    <input type="text" id="category" list="categoryList" autocomplete="off" 
                        class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500 editable-input"
                        style="cursor: text;" required>
                    <datalist id="categoryList"></datalist>
                </div>
                <div class="mb-4">
                    <label for="minStock" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ìµœì†Œ ì¬ê³  ê°œìˆ˜</label>
                    <input type="number" id="minStock" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" min="1" step="1" required>
                </div>                <div class="mb-4">
                    <label for="currentStock" class="block text-sm font-medium text-gray-700 dark:text-gray-300">í˜„ì¬ ì¬ê³ </label>
                    <input type="number" id="currentStock" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" min="0" value="0" required>
                </div>
                <div class="mb-4">
                    <label for="purchasePrice" class="block text-sm font-medium text-gray-700 dark:text-gray-300">êµ¬ë§¤ê¸ˆì•¡ (â‚©)</label>
                    <input type="number" id="purchasePrice" class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500" min="0" step="1" placeholder="ì˜ˆ: 5000">
                </div>
                <div class="mb-4">
                    <label for="equipmentGroup" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ì„¤ë¹„êµ°</label>
                    <input type="text" id="equipmentGroup" list="equipmentGroupList" autocomplete="off" 
                           class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500 editable-input"
                           style="cursor: text;" placeholder="ì˜ˆ: SMTë¼ì¸">
                    <datalist id="equipmentGroupList"></datalist>
                </div>
                <div class="mb-4">
                    <label for="boardName" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Boardëª…</label>
                    <input type="text" id="boardName" list="boardNameList" autocomplete="off" 
                           class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500 editable-input"
                           style="cursor: text;" placeholder="ì˜ˆ: MainBoard_V1.2">
                    <datalist id="boardNameList"></datalist>
                </div>
                <div class="mb-4">
                    <label for="serialNumber" class="block text-sm font-medium text-gray-700 dark:text-gray-300">S/N</label>
                    <input type="text" id="serialNumber" list="serialNumberList" autocomplete="off" 
                           class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500 editable-input"
                           style="cursor: text;" placeholder="ì˜ˆ: SN2025060001">
                    <datalist id="serialNumberList"></datalist>
                </div>
                <div class="mb-4">
                    <label for="operator" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ì‘ì—…ì</label>
                    <input type="text" id="operator" list="operatorList" autocomplete="off" 
                           class="mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-orange-500 focus:border-orange-500 editable-input"
                           style="cursor: text;" placeholder="ì˜ˆ: í™ê¸¸ë™">
                    <datalist id="operatorList"></datalist>
                </div>
                <div class="flex justify-end space-x-4">
                    <button type="button" id="cancelButton" class="px-4 py-2 bg-gray-300 dark:bg-gray-600 dark:text-white rounded-md hover:bg-gray-400 dark:hover:bg-gray-700">ì·¨ì†Œ</button>
                    <button type="submit" class="px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700">ë“±ë¡</button>
                </div>
            </form>
        </div>
    </div>
    <script>
        // ìƒˆ ë¶€í’ˆ ë“±ë¡ ëª¨ë‹¬ ê´€ë ¨ ì´ˆê¸°í™”
            function initializeNewPartModal() {
                const modal = document.getElementById('modal');
                const openModalButton = document.getElementById('openModalButton');
                const cancelButton = document.getElementById('cancelButton');
                const partForm = document.getElementById('partForm');

                if (!modal || !openModalButton || !cancelButton || !partForm) {
                    console.error('ìƒˆ ë¶€í’ˆ ë“±ë¡ ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                // ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì…ê³ ì¼ ê¸°ë³¸ê°’ ì„¤ì •
                document.getElementById('inDate').valueAsDate = new Date();

                // ì·¨ì†Œ ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
                cancelButton.addEventListener('click', () => {
                    modal.classList.add('hidden');
                });

                openModalButton.addEventListener('click', async () => {
                    // í¼ ì´ˆê¸°í™” - ì´ì „ ì…ë ¥ê°’ ì‚­ì œ
                    partForm.reset();
                    document.getElementById('inDate').valueAsDate = new Date();
                    
                    // ëª¨ë‹¬ ì—´ê¸° ì „ì— DB ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                    try {
                        const result = await window.partsAPI.getDbData();
                          if (result.success) {
                            // ë°ì´í„°ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”
                            document.getElementById('locationList').innerHTML = '';
                            document.getElementById('nameList').innerHTML = '';
                            document.getElementById('companyList').innerHTML = '';
                            document.getElementById('categoryList').innerHTML = '';
                            document.getElementById('equipmentGroupList').innerHTML = '';
                            document.getElementById('boardNameList').innerHTML = '';
                            document.getElementById('serialNumberList').innerHTML = '';
                            document.getElementById('operatorList').innerHTML = '';
                            
                            // ìœ„ì¹˜ ë°ì´í„° ì¶”ê°€
                            if (result.data.locations && result.data.locations.length > 0) {
                                result.data.locations.forEach(location => {
                                    if (location) {
                                        const option = document.createElement('option');
                                        option.value = location;
                                        document.getElementById('locationList').appendChild(option);
                                    }
                                });
                            }
                            
                            // í’ˆëª… ë°ì´í„° ì¶”ê°€
                            if (result.data.names && result.data.names.length > 0) {
                                result.data.names.forEach(name => {
                                    if (name) {
                                        const option = document.createElement('option');
                                        option.value = name;
                                        document.getElementById('nameList').appendChild(option);
                                    }
                                });
                            }
                            
                            // êµ¬ë§¤ì²˜ ë°ì´í„° ì¶”ê°€
                            if (result.data.companies && result.data.companies.length > 0) {
                                result.data.companies.forEach(company => {
                                    if (company) {
                                        const option = document.createElement('option');
                                        option.value = company;
                                        document.getElementById('companyList').appendChild(option);
                                    }
                                });
                            }

                            // ì¹´í…Œê³ ë¦¬ ë°ì´í„° ì¶”ê°€
                            if (result.data.categories && result.data.categories.length > 0) {
                                result.data.categories.forEach(category => {
                                    if (category) {
                                        const option = document.createElement('option');
                                        option.value = category;
                                        document.getElementById('categoryList').appendChild(option);
                                    }
                                });
                            }
                            
                            console.log('ê¸°ì¡´ DB ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
                        } else {
                            console.error('ê¸°ì¡´ DB ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', result.error);
                        }
                    } catch (error) {
                        console.error('API í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                    }
                    
                    // ëª¨ë‹¬ í‘œì‹œ
                    modal.classList.remove('hidden');
                });

                partForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    // í’ˆëª… ê°€ì ¸ì˜¤ê¸°
                    const partName = document.getElementById('name').value;
                    
                    try {
                        // í’ˆëª… ì¤‘ë³µ ì²´í¬
                        const checkResult = await window.partsAPI.checkDuplicatePart(partName);
                        
                        // ì¤‘ë³µ í’ˆëª… ë°œê²¬ ì‹œ ì¸í„°ë½ ì²˜ë¦¬
                        if (checkResult.success && checkResult.isDuplicate) {
                            // ëª¨ë‹¬ ë‹«ê¸°
                            modal.classList.add('hidden');
                            
                            // ì¤‘ë³µ ì•Œë¦¼ ì»¤ìŠ¤í…€ ëª¨ë‹¬ ìƒì„± ë° í‘œì‹œ
                            const alertModal = document.createElement('div');
                            alertModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                            alertModal.id = 'duplicateAlertModal';
                            
                            alertModal.innerHTML = `
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-md">
                                    <h3 class="text-lg font-semibold mb-4 dark:text-white">ì¤‘ë³µ ë¶€í’ˆ ì•Œë¦¼</h3>
                                    <p class="mb-4 dark:text-gray-300">ì¤‘ë³µë˜ëŠ” ë¶€í’ˆì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì•„ë˜ ì˜µì…˜ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”:</p>
                                    <div class="mt-6 flex justify-end space-x-3">
                                        <button id="closeAlertBtn" class="px-4 py-2 bg-gray-300 dark:bg-gray-600 dark:text-white rounded-md hover:bg-gray-400 dark:hover:bg-gray-700">
                                            ë‹«ê¸°
                                        </button>
                                        <button id="importBtn" class="px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700">
                                            <i class="fas fa-file-import mr-2"></i>ì…ê³  ì²˜ë¦¬
                                        </button>
                                        <button id="exportBtn" class="px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700">
                                            <i class="fas fa-file-export mr-2"></i>ì¶œê³  ì²˜ë¦¬
                                        </button>
                                    </div>
                                </div>
                            `;
                            
                            document.body.appendChild(alertModal);
                            
                            // ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                            document.getElementById('closeAlertBtn').addEventListener('click', () => {
                                document.getElementById('duplicateAlertModal').remove();
                            });
                            
                            document.getElementById('importBtn').addEventListener('click', () => {
                                document.getElementById('duplicateAlertModal').remove();
                                document.getElementById('inStockButton').click();
                            });
                            
                            document.getElementById('exportBtn').addEventListener('click', () => {
                                document.getElementById('duplicateAlertModal').remove();
                                document.getElementById('outStockButton').click();
                            });
                            
                            return; // ë“±ë¡ ì¤‘ë‹¨
                        }
                          // í¼ ë°ì´í„° ìˆ˜ì§‘
                        const formData = {
                            location: document.getElementById('location').value,
                            name: document.getElementById('name').value,
                            company: document.getElementById('company').value,
                            category: document.getElementById('category').value,
                            minStock: document.getElementById('minStock').value,
                            inDate: document.getElementById('inDate').value,
                            currentStock: document.getElementById('currentStock').value,
                            purchasePrice: document.getElementById('purchasePrice').value,
                            equipmentGroup: document.getElementById('equipmentGroup').value,
                            boardName: document.getElementById('boardName').value,
                            serialNumber: document.getElementById('serialNumber').value,
                            operator: document.getElementById('operator').value
                        };
                        
                        console.log('ë“±ë¡í•  ë°ì´í„°:', formData);
                        
                        // partsAPIë¥¼ í†µí•´ ë©”ì¸ í”„ë¡œì„¸ìŠ¤ë¡œ ë°ì´í„° ì „ì†¡
                        const result = await window.partsAPI.registerPart(formData);
                        
                        if (result.success) {
                            alert(`ë¶€í’ˆì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                            
                            // ëª¨ë‹¬ ë‹«ê³  í¼ ì´ˆê¸°í™”
                            modal.classList.add('hidden');
                            partForm.reset();
                            // ë‹¤ì‹œ ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì…ê³ ì¼ ì„¤ì •
                            document.getElementById('inDate').valueAsDate = new Date();
                            
                            // ì…ì¶œê³  ì´ë ¥ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                            const historyResult = await window.partsAPI.getHistoryData();
                            if (historyResult.success) {
                                originalHistoryData = historyResult.data || [];
                                renderHistoryData(originalHistoryData);
                            }
                        } else {
                            // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
                            alert(`ë¶€í’ˆ ë“±ë¡ ì‹¤íŒ¨: ${result.error}`);
                        }
                    } catch (error) {
                        console.error('API í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                        alert('ë¶€í’ˆ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    }
                });

                // input í•„ë“œ í¬ì»¤ìŠ¤ ë° í´ë¦­ ì²˜ë¦¬
                const editableInputs = document.querySelectorAll('.editable-input');
                editableInputs.forEach(input => {
                    // í´ë¦­ ì´ë²¤íŠ¸ - í•´ë‹¹ ìš”ì†Œì— í¬ì»¤ìŠ¤
                    input.addEventListener('click', function(e) {
                        this.focus();
                        // ì„ íƒ ë™ì‘ ë°©ì§€
                        e.preventDefault();
                    });
                    
                    // ê°•ì œë¡œ í¸ì§‘ ëª¨ë“œ í™œì„±í™”
                    input.addEventListener('focus', function() {
                        // ì»¤ì„œë¥¼ í…ìŠ¤íŠ¸ ëìœ¼ë¡œ ì´ë™
                        const val = this.value;
                        this.value = '';
                        this.value = val;
                        
                        // í•„ìš”í•œ ê²½ìš° ì„ íƒ ìƒíƒœ ì œê±°
                        setTimeout(() => {
                            this.selectionStart = this.selectionEnd = this.value.length;
                                               }, 10);
                    });
                });
            }

            // ...existing code...
    </script>
</body>
</html>
